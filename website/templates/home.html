{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
<br />
<h1 align="center">GREMA Events</h1>
<br />
<div class="row">
  {% for event in active_event %}
  <div class="col-md-4 position-relative">

    <div class="card mb-4 div-hover">
      {% if event.img_url %}
      <img src="{{ event.img_url }}" class="card-img-top" alt="{{ event.name }}">
      {% else %}
      <img src="{{ url_for('static', filename='images/gremaLogo.png') }}" class="card-img-top" alt="{{ event.name }}">
      {% endif %}
      <div class="card-body">

        <h5 class="card-title">
          <a href="/event-attendance/{{ event.id }}">{{ event.name }}</a>
        </h5>
        Event Date: {{event.date.strftime('%d-%m-%Y')}} <br />
        Maximum capacity: {{event.max_guest_num}} people <br />
        Member price: {{event.member_price}} € <br />
        Member price (Child): {{event.member_child_price}} € <br />
        Guest price: {{event.guest_price}} € <br />
        Description: {{event.description}}<br />
        Available tickets:
        {% for detail in event_details %}
        {% if detail.event == event.id %}
        {% if detail.event == event.id and detail.sold_out %}
        <span style="color:rgb(253, 41, 4)">{{detail.tickets_remaining}}<br /></span>
        {% else %}
          {% if detail.warning_few_tickets %}
          <span style="color:rgb(253, 199, 4)">{{detail.tickets_remaining}}<br /></span>
          {% else %}
          <span style="color:rgb(1, 97, 25)">{{detail.tickets_remaining}}/{{event.max_guest_num}}<br /></span><br />
          {% endif %}
          {% endif %}
          {% endif %}
        {% endfor %}
      </div>
      {% for detail in event_details %}
      {% if detail.event == event.id and detail.sold_out %}
      <div
        class="sold-out-overlay position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center">
        <img src="{{ url_for('static', filename='images/sold_out.png') }}" alt="Sold Out"
          style="max-width: 80%; max-height: 80%;">
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}